#!/usr/local/bin/bash
args=("$@")
for ((arg=0; arg<${#args[@]}; arg++)) ; do
    if test x"${args[$arg]}" = x-o ; then
        objarg=$((arg+1))
        break
    fi
done
if test x$objarg = x ; then
    echo 'Error: no -o on compiler command line' 1>&2
    exit 1
fi
lo="${args[$objarg]}"
obj="${lo%.lo}"
if test x"$lo" = x"$obj" ; then
    echo "Error: libtool object file name \"$lo\" does not end in .lo" 1>&2
    exit 1
fi
objbase="${obj##*/}"
non_pic_object="$obj.o"
args[$objarg]="$non_pic_object"
"${args[@]}" || exit $?
{
echo "# $lo - a libtool object file"
echo "# Generated by doltcompile, not libtool"
echo pic_object=none
echo "non_pic_object='${objbase}.o'"
} > "$lo"
